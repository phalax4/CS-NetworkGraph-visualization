<base href="http://www.cs.utexas.edu/~gouda/cs356sp08/quiz4/">
-------------------------------------------------------------------------------
Mohamed G. Gouda                                        CS 356
Spring      2008                                        Quiz 4
-------------------------------------------------------------------------------

Redesign process p in the connection protocol in Section 6.1 such
that, once process q has accepted a connection, process p is allowed
to send any number of data messages in that connection.

-------------------------------------------------------------------------------

Solution: 

Process P

inp m      : integer
var conp   : boolean            {init. false}
    cansnd : boolean            {init. false}

begin
    timeout ~conp ^ (#ch.p.q + #ch.q.p = 0) 
                                       -> send crqst to q
[]  rcv crply from q                   -> conp, cansnd := true, true
[]  conp                               -> if cansnd -> send data to q;
                                          [] true   -> send drqst to q;
                                                       cansnd := false
                                          fi
[]  rcv drply from q                   -> conp := false
end                

-------------------------------------------------------------------------------
